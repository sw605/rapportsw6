\subsection{Communication with \gls{astep}}\label{ssec:communicationwithastep}
To be able to utilize the \gls{astep} system, the communication protocol and its functions must be analyzed. 
The analysis is based on the current development and plan of the API and other functions.

% \gls{astep} organization - groups
The intended functions are established in collaboration with other project groups responsible for the \gls{astep} system side of the development. 
The design of the \gls{astep} system is currently consisting of an API that apps and services can communicate with, and a backend with user management and location based services, which is stored in a database system.

% What is stored in \gls{astep}
The \gls{astep} system will store information regarding location data, and basic user information. 
The data stored in the \gls{astep} system, relevant to this project solution, is:
\begin{itemize}
	\item Location data consisting of userID, routeID, GPS coordinates and timestamp
	\item Username
	\item Password
\end{itemize}

The \gls{astep} user management system does not provide storage of data regarding contact information for \gls{astep} users.
The only information stored is a username and password to keep the \gls{astep} core as simple as possible.
Additional information that is required to make the app work as intended is each of the app groups own responsibility.
The \gls{astep} users are made to ensure the correct permissions are given to the correct user and so that the appropriate data is returned to each user.
An API call cannot be done without the user first being authenticated with a valid login.

% How to cummunicate with \gls{astep}
The communication with \gls{astep} is done through a REST API over HyperText Transfer Protocol, decided in agreement between the \gls{astep} project groups.
REST is an abbreviation of Representational State Transfer, and is a communication design often used in for HTTP-communication \cite{REST}.
Accordingly, the communication is performed by making queries to the \gls{astep} system. 
All communication must be done as a request from the device, to which the \gls{astep} server will respond.

% api functions
The currently available API functions at this stage of the development of \gls{astep} from user management and location services can be seen in Table \ref{tab:sprint2-api}.
The API is providing a POST-request under the name ``PostLocationDat'', as listed in \ref{tab:sprint2-api}, which is the current method to use when sending location data to the \gls{astep} system.
The call will accept location data as a coordinate consisting of longitude and latitude, a precision value, and a value representing time of day in milliseconds.

\begin{table}[!ht]
	\centering
	\begin{tabular}{ll}
		LBS & UM    \\
		\hline
		\begin{tabular}[t]{@{}l@{}}
			GetAllEntitiesInArea\\ GetAllEntitiesInTimePeriod\\ GetAllGroupMemebersLocationAndName\\ GetAllFriendsInArea\\ GetAllFriendsInRadius\\ GetAllGroupMembersInArea\\ GetAllGroupMembersInRadius\\ PostLocationData\end{tabular}
		&
		\begin{tabular}[t]{@{}l@{}}
			Create user\\ Get token\\ Update password\\ Edit privacy settings\\ Allow user2 to access user1's info\end{tabular}
	\end{tabular}
	\caption{Currently planned \gls{astep} API functions.}
	\label{tab:sprint2-api}
\end{table}


As both the \gls{astep} service and Android system have been analyzed it is possible to establish a set of requirements for the second sprint.